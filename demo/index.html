<!doctype html>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="chrome=1"/>
		<title>Quantum Physics Simulator by mailmindlin</title>
		
		<!--Meta tags -->
		<meta name="description" content="A simulator for the quantum properties of theoretical molecules."/>
		<meta name="robots" content="INDEX, noimageindex"/><!--no image index is just for copyright stuff-->
		<meta name="revisit-after" content="2 days"/><!--because of constant updates-->
		<meta name="author" content="mailmindlin, jschrier"/>
		
		<!-- github's css -->
		<link rel="stylesheet" href="../stylesheets/styles.css" onerror="loadError('Github\'s styles.css')"/>
		<link rel="stylesheet" href="../stylesheets/pygment_trac.css" onerror="loadError('Github\'s pygment_trac.css')"/>
		<!-- my css -->
		<link rel="stylesheet" href="main.css" onerror="loadError('main.css')"/>
		<link rel="stylesheet" href="animations.css" onerror="loadError('animations.css')"/>
		<link rel="stylesheet" href="cursor-props.css" onerror="loadError('cursor-props.css')"/>
		<!-- jquery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" class="imp-scr1" onerror="loadError('jquery 1.7.1')"></script>
		<script src="../javascripts/respond.js" class="imp-scr2" onerror="loadError('Github\'s respond.js')"></script>
		<!-- JSMol -->
		<script type="text/javascript" src="../jsmol/jsmol/JSmol.min.js" onerror="loadError('JSmol.js')"></script>
		<!-- my scripts -->
		<script type="text/javascript" onerror="loadError('Main loader')">//<![CDATA[
			//cross-compatibility
			//indexedDB stuff
			window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
			window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction;
			window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange;

			//setup std. objects

			/**
			 * DB interface object. Acts as a buffer between the database and JS code
			 */
			 window['DBInterface'] = function(args) {
			 	//safety check
			 	if(typeof args === 'undefined') args = {};

			 	//define self
			 	var self = Object.create(null);

			 	//vardef
			 	self.dbName 	= (typeof args.dbName !== 'undefined')?args.dbName:"Generic Database";
			 	self.dbVersion 	= (typeof args.version === 'number')?args.version:3;
			 	self.tables	= (typeof args.tables === "object")?args.tables:[];
			 	self.openRequest= null;
			 	self.objectStore= null;
			 	self.storeBuffer= [];
			 	self.state	= -1;
			 	self.db		= null;

			 	//functiondef
			 	self.setup = function() {
			 		console.log("Initializing database "+self.dbName + "...");
			 		self.state = 0;
			 		self.openRequest = window.indexedDB.open(self.dbName, self.dbVersion);
			 		self.openRequest.onerror = self.onerror;
			 		self.openRequest.onsuccess = self.onsuccess;
			 		self.openRequest.onupgradeneeded = self.onupgradeneeded;
			 		console.log("\tDone.");
			 	};
			 	self.onerror = function(error) {
			 		if(self.state==0){
			 			console.error([new Error("DB creation failed"),error]);
			 			return;
			 		}
			 		//generic mesage
			 		console.error([new Error("An error occured!" + (typeof error !== 'undefined')?("\n"+error.message):""),error]);
			 	};
			 	self.onsuccess = function(event) {
			 		console.log(["Success!",event]);
			 		if (self.state == 0 && self.openRequest == "done") {
			 			console.log("The db is open!");
			 			self.db = event.result;
			 			self.state = 1;
			 		}
			 	};
			 	self.onupgradeneeded = function(event) {
			 		console.log("Upgrading database...");
			 		self.db = event.target.result;
			 		//create tables
			 		for (var i = 0; i < self.tables.length; i++) {
			 			console.log("\tCreating table "+self.table[i].name+" ("+(i+1)+"/"+self.tables.length+")...");
			 			var table = self.tables[i];
			 			table.target = self.db.createObjectStore(table.name, table.name, {keyPath: table.keyPath});
			 			//create fields
			 			for(var i=0;i<table.fields.length;i++){
			 				var field = table.fields[i];
			 				table.target.createIndex(field.name, (((typeof field.args==='object') && (typeof field.args.unique !== 'undefined'))?field.args:{unique: false}));
			 				table.fields[i]=field;
			 			}
			 			//call any internal handler
			 			if(typeof table.onCreate() === 'function')table.onCreate();
			 			self.tables[i]=table;
			 		}
			 		console.log("\tDone.");
			 	};
			 	//setup object
			 	if((typeof args.waitForSetup==='undefined')||(!args.waitForSetup))self.setup();
			 	return self;
			 };
			/**
			 * Loader object.
			 * Basically handles scripts that load or fail to load, and smooths it out.
			 */
			window['Loader'] = (function() {
				var self = this;
				//vardef
				self.hasErrors=false;
				self.failureQueue = {};
				self.successQueue = {};
				self.waitingQueue = {};
				self.db		  = new DBInterface({
					name:"ScriptDB",
					version:3,
					tables: [{name: "Files",
						fields: [{name:"Name", args:{unique: true}},
							{name:"Version", args:{unique: false}},
							{name:"Data",args:{unique: false}}]},
						{name: "Versions",
						fields: [{name:"Name", args:{unique: true}},
							{name:"Date Last Updated",args:{unique:false}},
							{name:"Files",args:{unique:false}}]}]
					});
				//functiondef
				self.onSuccess = function(src, name) {
					var obj = Object.create(null);
					obj.src = src;
					obj.name = name;
					self.successQueue[name] = obj;
					delete self.waitingQueue[name];
					//TODO remove object from the waitingQueue
					console.log("Loaded " + name + " from " + src);
				};
				self.onFail = function(src, name) {
					self.hasErrors=true;
					var obj = Object.create(null);
					obj.src = src;
					obj.name = name;
					self.failureQueue = obj;
					delete self.waitingQueue[name];
					//TODO remove object from the waitingQueue
					console.log("Failed to load " + name + " from " + src);
				};
				self.getFromCache = function(src, name, version) {
					if (typeof version === "undefined")version = "LATEST";
					//TODO load scripts from localstorage/indexedDB
				};
				self.want = function(src, name, version) {
					if(typeof version === 'undefined')version = "LATEST";
					var obj = Object.create(null);
					obj.src = src;
					obj.name = name;
					obj.version = version;
					self.waitingQueue[name] = (obj);
					console.log("Waiting to load " + name + " from " + src);
					return self;
				};
				return self;
			})();
			//register scripts to load
			Loader.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/session.js",		"session.js",		"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/utils.js",		"utils.js",		"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/logger.js",		"logger.js",		"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/help.js",		"help.js",		"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/networking.js",	"networking.js",	"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/renderer.js",		"renderer.js",		"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/renderUtils.js",	"renderUtils.js",	"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/input.js",		"input.js",		"LATEST")
				.want("https://rawgit.com/mailmindlin/quantum-physics-sim/master/jsmol.js",		"jsmol.js",		"LATEST");
				
				
			var hasHAdLoadError = false;
			function loadError(ev){
				if(hasHadLoadError)return;
				hasHadLoadError=true;
				console.log(ev);
				Loader.onFail("GITHUB",name);
				var reload = confirm("Sorry, but one or more of the scripts on this page failed to load("+ev+").\nWould you like to reload?");
				if(reload)location.reload();
			}
		//]]></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/session.js" onerror="loadError('session.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/session.js','session.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/utils.js" onerror="loadError('utils.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/utils.js','utils.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/logger.js" onerror="loadError('logger.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/logger.js','logger.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/help.js" onerror="loadError('help.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/help.js','help.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/networking.js" onerror="loadError('networking.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/networking.js','networking.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/renderer.js" onerror="loadError('renderer.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/renderer.js','renderer.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/renderUtils.js" onerror="loadError('renderUtils.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/renderUtils.js','renderUtils.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/input.js" onerror="loadError('input.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/input.js','input.js')"></script>
		<script type="text/javascript" src="https://rawgit.com/mailmindlin/quantum-physics-sim/master/jsmol.js" onerror="loadError('jsmol.js')" onload="Loader.onSuccess('https://rawgit.com/mailmindlin/quantum-physics-sim/master/jsmol.js','jsmol.js')"></script>
		<script type="text/javascript" src="main.js" onerror="loadError('main.js')"></script>
		<!--<script type="text/javascript" src="main.min.js"></script>-->
		<!--[if lt IE 9]>
			<script src="//html5shiv.googlecode.com/svn/trunk/html5.js" class="imp-scr13></script>
		<![endif]-->
		<!--[if lt IE 8]>
			<link rel="stylesheet" href="../stylesheets/ie.css">
		<![endif]-->
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>

	</head>
	<body onload="load()">
		<div id="header">
			<nav>
				<li class="fork"><a href="https://github.com/mailmindlin/quantum-physics-sim">View On GitHub</a></li>
				<li class="downloads"><a href="../">Back to main page</a></li>
			</nav>
		</div><!-- end header -->

		<div class="wrapper">

			<section>
				<div id="title">
					<h1>Quantum Physics Simulator</h1>
					<p>Free online simulator</p>
					<hr>
					<span class="credits left">Project maintained by <a href="https://github.com/mailmindlin">mailmindlin</a></span>
					<span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
				</div>
		
				<h3><a name="demo" class="anchor" href="#demo-main"><span class="octicon octicon-link"></span></a>Use, and be amazed.</h3>
		
				<div class="simulator-canvas"></div>
				<div id="input-test">If you are seeing this, something is wrong. (seriously)</div>
				<script type="text/javascript">
					//setup canvas as simulator
					//called on body load
					function load() {
						var canvas = $('.simulator-canvas')[0];
						var input = $('#input-test')[0];
						window['inp']=new Input({name:'input-test1', dom:input});
						//TODO finish
					}
				</script>
				<br/>
				
				<h3><a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>How to use</h3>
				<p>
					<!--
					To use this is pretty easy.
					<br/>
					Just type in the chemical symbol for the atom in the 'element' colunm, and type in the cartesian coordinates to the x y and z fields (scientific notation & decimals supported).
					To add anoter atom, push <code>tab</code> on the last textbox on the last row. If a box turns red, hover over it to find out the problem.
					The data is updated realtime (ish).
					-->
					Good question. As of the time of this being written, it wasn't functional at all (makes these instructions hard to write)! If the simulator is functional
					or semi-functional when you read this, then please submit an issue <a href="https://github.com/mailmindlin/quantum-physics-sim/issues/new">here</a>, so I remember.
				</p>
				<h3><a name="faq" class="anchor" href="#faq"><span class="octicon octicon-link"></span></a>FAQ</h3>
				<p>
					<ul>
						<li>
							<a href="#usage>$" name="usage>$" class="anchor"><span class="octicon octicon-link"></span></a>
							<!-- add something here -->
						</li>
					</ul>
				</p>
				
			</section>
		</div>
		<div id="help-div"></div>
		<center id="btm-arrow">&#8978;</center>
		<center id="footer-wrapper">
			<!--<table border="0px"><tr><td><button>Show/Hide console</button><!--</td></tr></table>-->
		</center>
		<!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
	</body>
</html>
